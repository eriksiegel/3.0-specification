<p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
	        xmlns:ex="http://example.com/ns/example"
                version="3.0">
<p:input port="source"/>
<p:output port="result"/>

<p:declare-step type="ex:dir-list">
  <p:output port="result"/>
  <p:option name="path"/>

  <p:choose>
    <p:when test="p:value-available('path')">
      <p:directory-list>
	<p:with-option name="path" select="$path"/>
      </p:directory-list>
    </p:when>
    <p:otherwise>
      <p:directory-list path="."/>
    </p:otherwise>
  </p:choose>
</p:declare-step>

<ex:dir-list path=".."/>

</p:declare-step>
